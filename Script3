def query_range(promql: str) -> dict:
    try:
        start_ts = thirty_minutes_ago_unix()
        end_ts = now_unix()

        print("\n[QUERY] PromQL:")
        print(promql)
        print("[QUERY] Time Range (Unix):", start_ts, "to", end_ts)

        response = requests.get(
            f"{PROMETHEUS_URL}/api/v1/query_range",
            params={
                "query": promql,
                "start": start_ts,
                "end": end_ts,
                "step": "300"
            },
            auth=HTTPBasicAuth(PROM_USER, PROM_PASS),
            proxies=PROXIES,
            verify=VERIFY_TLS,
            timeout=60
        )

        response.raise_for_status()
        return response.json()
    except Exception as e:
        return {"error": str(e)}
